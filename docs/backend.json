
{
  "entities": {
    "Raffle": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Raffle",
      "type": "object",
      "description": "Represents a raffle event.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Raffle entity."
        },
        "adminId": {
          "type": "string",
          "description": "The UID of the admin user who owns this raffle."
        },
        "name": {
          "type": "string",
          "description": "The name of the raffle."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the raffle."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image associated with the raffle.",
          "format": "uri"
        },
        "price": {
          "type": "number",
          "description": "The price of a single ticket for the raffle."
        },
        "totalTickets": {
          "type": "number",
          "description": "The total number of tickets available for the raffle."
        },
        "endDate": {
          "type": "string",
          "description": "The date and time when the raffle ends.",
          "format": "date-time"
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the raffle is currently active."
        }
      },
      "required": [
        "id",
        "adminId",
        "name",
        "description",
        "imageUrl",
        "price",
        "totalTickets",
        "endDate",
        "isActive"
      ]
    },
    "Ticket": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Ticket",
      "type": "object",
      "description": "Represents a ticket purchased for a raffle.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Ticket entity."
        },
        "ticketNumber": {
          "type": "number",
          "description": "The unique number assigned to the ticket."
        },
        "status": {
          "type": "string",
          "description": "The current status of the ticket (e.g., available, reserved, paid)."
        },
        "purchaserName": {
          "type": "string",
          "description": "The name of the person who purchased the ticket."
        },
        "purchaserPhoneNumber": {
          "type": "string",
          "description": "The phone number of the person who purchased the ticket."
        },
        "raffleId": {
          "type": "string",
          "description": "Reference to Raffle. (Relationship: Raffle 1:N Ticket)"
        },
        "purchaseDate": {
          "type": "string",
          "description": "The date and time when the ticket was purchased.",
          "format": "date-time"
        },
        "isPaymentConfirmed": {
          "type": "boolean",
          "description": "Indicates whether the payment for the ticket has been confirmed."
        }
      },
      "required": [
        "id",
        "ticketNumber",
        "status",
        "purchaserName",
        "purchaserPhoneNumber",
        "raffleId",
        "purchaseDate",
        "isPaymentConfirmed"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/admins/{adminId}",
        "definition": {
          "entityName": "admin",
          "schema": {
            "$ref": "#/backend/entities/admin"
          },
          "description": "Collection of admin users. Existence of document determines admin role.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier of the admin user."
            }
          ]
        }
      },
      {
        "path": "/raffles/{raffleId}",
        "definition": {
          "entityName": "Raffle",
          "schema": {
            "$ref": "#/backend/entities/Raffle"
          },
          "description": "Top-level collection of all raffles. Publicly readable.",
          "params": [
            {
              "name": "raffleId",
              "description": "The unique identifier of the raffle."
            }
          ]
        }
      },
      {
        "path": "/raffles/{raffleId}/tickets/{ticketId}",
        "definition": {
          "entityName": "Ticket",
          "schema": {
            "$ref": "#/backend/entities/Ticket"
          },
          "description": "Collection of tickets associated with a specific raffle.",
          "params": [
            {
              "name": "raffleId",
              "description": "The unique identifier of the raffle."
            },
            {
              "name": "ticketId",
              "description": "The unique identifier of the ticket."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure has been updated for public read access. Raffles are now in a top-level `/raffles` collection to allow any user to view them, which is necessary for the main page. Security is maintained by embedding the `adminId` within each raffle document, and using security rules to ensure only the owning admin can perform write operations (create, update, delete). This structure is secure, scalable, and aligns with the application's access patterns."
  }
}
